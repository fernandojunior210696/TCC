annotate(geom = "text",
x = mean(qnt_days_pop$count)+13,
y = 1,
label = paste0("Média: ", round(mean(qnt_days_pop$count), 3)))+
labs(title = "Distribution of Days a Song Remains at the Top 200",
subtitle = "Most Pop Songs (since Jan 2017)",
x = "Count",
y = "")
# 8.1 Analysing distribuition in order to remove outliers
qnt_days_pop$count %>%
quantile(probs = c(seq(0, 0.75, 0.25), seq(0.9, 1, 0.01)))
# From 8.1, we can remove observation above 97% (387)
qnt_days_pop %<>%
filter(count < 387)
# 8.2 Analysing the distribuition without outliers
qnt_days_pop %>%
ggplot()+
geom_density(aes(x = count, y = ..count..),
fill = "#2980b9")+
theme_minimal()+
geom_vline(aes(xintercept = mean(qnt_days_pop$count)),
color = '#8e44ad')+
geom_vline(aes(xintercept = median(qnt_days_pop$count)),
color = '#27ae60')+
annotate(geom = "text",
x = mean(qnt_days_pop$count)+23,
y = 40,
label = paste0("Média: ", round(mean(qnt_days_pop$count), 3)),
color = '#8e44ad')+
annotate(geom = "text",
x = median(qnt_days_pop$count)+23,
y = 30,
label = paste0("Mediana: ", round(median(qnt_days_pop$count), 3)),
color = '#27ae60')+
labs(title = "Distribution of Days a Song Remains at the Top 200",
subtitle = "Most Pop Songs (since Jan 2017)",
x = "Count",
y = "")
View(most_popular)
qnt_monthly_pop %>%
ggplot()+
geom_density(aes(x = count, y = ..count..),
fill = "#2980b9")+
theme_minimal()+
geom_vline(aes(xintercept = mean(qnt_monthly_pop$count)))+
annotate(geom = "text",
x = mean(qnt_monthly_pop$count)+13,
y = 1,
label = paste0("Média: ", round(mean(qnt_monthly_pop$count), 3)))+
labs(title = "Distribution of Songs in Each Month",
subtitle = "Most Pop Songs (since Jan 2017)",
x = "Count",
y = "")
View(all_songs)
all_songs %>%
ggplot()+
geom_histogram(aes(track.album.release_date))
all_songs %>%
ggplot()+
geom_histogram(aes(track.album.release_date),
color = '#8e44ad')
all_songs %>%
ggplot()+
geom_histogram(aes(track.album.release_date),
fill = '#8e44ad')
all_songs %>%
ggplot()+
geom_histogram(aes(x = track.album.release_date, y= ..count..),
fill = '#2980b9')
all_songs %>%
ggplot()+
geom_histogram(aes(x = track.album.release_date, y= ..count..),
fill = '#2980b9')+
theme_minimal()+
geom_vline(aes(xintercept = median(all_songs$track.album.release_date)))+
annotate(geom = "text",
x = median(all_songs$track.album.release_date)+13,
y = 20000,
label = paste0("Média: ", round(median(all_songs$track.album.release_date), 3)))+
labs(title = "Distribution of Song Release Date",
subtitle = "All songs",
x = "Popularity Index",
y = "")
all_songs %>%
ggplot()+
geom_histogram(aes(x = track.album.release_date, y= ..count..),
fill = '#2980b9')+
theme_minimal()+
geom_vline(aes(xintercept = median(all_songs$track.album.release_date)))+
annotate(geom = "text",
x = median(all_songs$track.album.release_date)+13,
y = 20000,
label = paste0("Média: ", round(median(all_songs$track.album.release_date), 3)))+
labs(title = "Distribution of Song Release Date",
subtitle = "All songs",
x = "Release Date",
y = "")
median(all_songs$track.album.release_date)
median(all_songs$track.album.release_date, na.rm = T)
year(median(all_songs$track.album.release_date, na.rm = T))
all_songs %>%
ggplot()+
geom_histogram(aes(x = track.album.release_date, y= ..count..),
fill = '#2980b9')+
theme_minimal()+
geom_vline(aes(xintercept = year(median(all_songs$track.album.release_date, na.rm = T))))+
annotate(geom = "text",
x = year(median(all_songs$track.album.release_date, na.rm = T))+13,
y = 20000,
label = paste0("Mediana: ", year(median(all_songs$track.album.release_date, na.rm = T))))+
labs(title = "Distribution of Song Release Date",
subtitle = "All songs",
x = "Release Date",
y = "")
all_songs %>%
ggplot()+
geom_histogram(aes(x = track.album.release_date, y= ..count..),
fill = '#2980b9')+
theme_minimal()+
geom_vline(aes(xintercept = year(median(all_songs$track.album.release_date, na.rm = T))))+
annotate(geom = "text",
x = year(median(all_songs$track.album.release_date, na.rm = T))+13,
y = 20000,
label = paste0("Média: ", round(median(all_songs$track.album.release_date), 3)))+
labs(title = "Distribution of Song Release Date",
subtitle = "All songs",
x = "Release Date",
y = "")
all_songs %>%
ggplot()+
geom_histogram(aes(x = track.album.release_date, y= ..count..),
fill = '#2980b9')+
theme_minimal()+
geom_vline(aes(xintercept = year(median(all_songs$track.album.release_date, na.rm = T))))+
annotate(geom = "text",
x = median(all_songs$track.album.release_date)+13,
y = 20000,
label = paste0("Média: ", round(median(all_songs$track.album.release_date), 3)))+
labs(title = "Distribution of Song Release Date",
subtitle = "All songs",
x = "Release Date",
y = "")
all_songs %>%
ggplot()+
geom_histogram(aes(x = track.album.release_date, y= ..count..),
fill = '#2980b9')+
theme_minimal()+
geom_vline(aes(xintercept = year(median(all_songs$track.album.release_date, na.rm = T))))+
annotate(geom = "text",
x = median(all_songs$track.album.release_date)+13,
y = 20000,
label = paste0("Média: ", round(median(all_songs$track.album.release_date), 3)))+
labs(title = "Distribution of Song Release Date",
subtitle = "All songs",
x = "Release Date",
y = "")
all_songs %>%
ggplot()+
geom_histogram(aes(x = track.album.release_date, y= ..count..),
fill = '#2980b9')+
theme_minimal()+
geom_vline(aes(xintercept = year(median(all_songs$track.album.release_date, na.rm = T))))+
annotate(geom = "text",
x = year(median(all_songs$track.album.release_date, na.rm = T))+13,
y = 20000,
label = paste0("Média: ", round(median(all_songs$track.album.release_date), 3)))+
labs(title = "Distribution of Song Release Date",
subtitle = "All songs",
x = "Release Date",
y = "")
all_songs %>%
ggplot()+
geom_histogram(aes(x = track.album.release_date, y= ..count..),
fill = '#2980b9')+
theme_minimal()+
geom_vline(aes(xintercept = year(median(all_songs$track.album.release_date, na.rm = T))))+
annotate(geom = "text",
x = median(all_songs$track.album.release_date, na.rm = T)+13,
y = 20000,
label = paste0("Média: ", round(median(all_songs$track.album.release_date), 3)))+
labs(title = "Distribution of Song Release Date",
subtitle = "All songs",
x = "Release Date",
y = "")
label = paste0("Mediana: ", year(median(all_songs$track.album.release_date, na.rm = T)))+
all_songs %>%
ggplot()+
geom_histogram(aes(x = track.album.release_date, y= ..count..),
fill = '#2980b9')+
theme_minimal()+
geom_vline(aes(xintercept = year(median(all_songs$track.album.release_date, na.rm = T))))+
annotate(geom = "text",
x = median(all_songs$track.album.release_date, na.rm = T)+13,
y = 20000,
label = paste0("Mediana: ", year(median(all_songs$track.album.release_date, na.rm = T))))+
labs(title = "Distribution of Song Release Date",
subtitle = "All songs",
x = "Release Date",
y = "")
all_songs %>%
ggplot()+
geom_histogram(aes(x = track.album.release_date, y= ..count..),
fill = '#2980b9')+
theme_minimal()+
geom_vline(aes(xintercept = year(median(all_songs$track.album.release_date, na.rm = T))))+
annotate(geom = "text",
x = median(all_songs$track.album.release_date, na.rm = T),
y = 20000,
label = paste0("Mediana: ", year(median(all_songs$track.album.release_date, na.rm = T))))+
labs(title = "Distribution of Song Release Date",
subtitle = "All songs",
x = "Release Date",
y = "")
all_songs %>%
ggplot()+
geom_histogram(aes(x = track.album.release_date, y= ..count..),
fill = '#2980b9')+
theme_minimal()+
geom_vline(aes(xintercept = year(median(all_songs$track.album.release_date, na.rm = T))))+
annotate(geom = "text",
x = median(all_songs$track.album.release_date, na.rm = T)-1,
y = 20000,
label = paste0("Mediana: ", year(median(all_songs$track.album.release_date, na.rm = T))))+
labs(title = "Distribution of Song Release Date",
subtitle = "All songs",
x = "Release Date",
y = "")
all_songs %>%
ggplot()+
geom_histogram(aes(x = track.album.release_date, y= ..count..),
fill = '#2980b9')+
theme_minimal()+
geom_vline(aes(xintercept = year(median(all_songs$track.album.release_date, na.rm = T))))+
annotate(geom = "text",
x = median(all_songs$track.album.release_date, na.rm = T)-40,
y = 20000,
label = paste0("Mediana: ", year(median(all_songs$track.album.release_date, na.rm = T))))+
labs(title = "Distribution of Song Release Date",
subtitle = "All songs",
x = "Release Date",
y = "")
all_songs %>%
ggplot()+
geom_histogram(aes(x = track.album.release_date, y= ..count..),
fill = '#2980b9')+
theme_minimal()+
geom_vline(aes(xintercept = year(median(all_songs$track.album.release_date, na.rm = T))))+
annotate(geom = "text",
x = median(all_songs$track.album.release_date, na.rm = T)-4000,
y = 20000,
label = paste0("Mediana: ", year(median(all_songs$track.album.release_date, na.rm = T))))+
labs(title = "Distribution of Song Release Date",
subtitle = "All songs",
x = "Release Date",
y = "")
all_songs %>%
ggplot()+
geom_histogram(aes(x = track.album.release_date, y= ..count..),
fill = '#2980b9')+
theme_minimal()+
geom_vline(aes(xintercept = year(median(all_songs$track.album.release_date, na.rm = T))))+
annotate(geom = "text",
x = median(all_songs$track.album.release_date, na.rm = T)-10000,
y = 20000,
label = paste0("Mediana: ", year(median(all_songs$track.album.release_date, na.rm = T))))+
labs(title = "Distribution of Song Release Date",
subtitle = "All songs",
x = "Release Date",
y = "")
all_songs %>%
ggplot()+
geom_histogram(aes(x = track.album.release_date, y= ..count..),
fill = '#2980b9')+
theme_minimal()+
geom_vline(aes(xintercept = year(median(all_songs$track.album.release_date, na.rm = T))))+
annotate(geom = "text",
x = median(all_songs$track.album.release_date, na.rm = T)-20000,
y = 20000,
label = paste0("Mediana: ", year(median(all_songs$track.album.release_date, na.rm = T))))+
labs(title = "Distribution of Song Release Date",
subtitle = "All songs",
x = "Release Date",
y = "")
most_popular %>%
ggplot()+
geom_histogram(aes(x = track.album.release_date, y= ..count..),
fill = '#2980b9')+
theme_minimal()+
geom_vline(aes(xintercept = year(median(most_popular$track.album.release_date, na.rm = T))))+
annotate(geom = "text",
x = median(most_popular$track.album.release_date, na.rm = T)-20000,
y = 20000,
label = paste0("Mediana: ", year(median(most_popular$track.album.release_date, na.rm = T))))+
labs(title = "Distribution of Song Release Date",
subtitle = "Popular songs (200 Top)",
x = "Release Date",
y = "")
most_popular %>%
ggplot()+
geom_histogram(aes(x = track.album.release_date, y= ..count..),
fill = '#2980b9')+
theme_minimal()+
geom_vline(aes(xintercept = median(most_popular$track.album.release_date, na.rm = T)))+
annotate(geom = "text",
x = median(most_popular$track.album.release_date, na.rm = T)-20000,
y = 20000,
label = paste0("Mediana: ", year(median(most_popular$track.album.release_date, na.rm = T))))+
labs(title = "Distribution of Song Release Date",
subtitle = "Popular songs (200 Top)",
x = "Release Date",
y = "")
most_popular %>%
ggplot()+
geom_histogram(aes(x = track.album.release_date, y= ..count..),
fill = '#2980b9')+
theme_minimal()+
geom_vline(aes(xintercept = median(most_popular$track.album.release_date, na.rm = T)))+
annotate(geom = "text",
x = median(most_popular$track.album.release_date, na.rm = T)+13,
y = 20000,
label = paste0("Mediana: ", year(median(most_popular$track.album.release_date, na.rm = T))))+
labs(title = "Distribution of Song Release Date",
subtitle = "Popular songs (200 Top)",
x = "Release Date",
y = "")
most_popular %>%
ggplot()+
geom_histogram(aes(x = track.album.release_date, y= ..count..),
fill = '#2980b9')+
theme_minimal()+
geom_vline(aes(xintercept = median(most_popular$track.album.release_date, na.rm = T)))+
annotate(geom = "text",
x = median(most_popular$track.album.release_date, na.rm = T)-1000,
y = 20000,
label = paste0("Mediana: ", year(median(most_popular$track.album.release_date, na.rm = T))))+
labs(title = "Distribution of Song Release Date",
subtitle = "Popular songs (200 Top)",
x = "Release Date",
y = "")
all_songs %>%
ggplot()+
geom_histogram(aes(x = track.album.release_date, y= ..count..),
fill = '#2980b9')+
theme_minimal()+
geom_vline(aes(xintercept = median(all_songs$track.album.release_date, na.rm = T)))+
annotate(geom = "text",
x = median(all_songs$track.album.release_date, na.rm = T)-5000,
y = 20000,
label = paste0("Mediana: ", year(median(all_songs$track.album.release_date, na.rm = T))))+
labs(title = "Distribution of Song Release Date",
subtitle = "All songs",
x = "Release Date",
y = "")
most_popular %>%
ggplot()+
geom_histogram(aes(x = track.album.release_date, y= ..count..),
fill = '#2980b9')+
theme_minimal()+
geom_vline(aes(xintercept = median(most_popular$track.album.release_date, na.rm = T)))+
annotate(geom = "text",
x = median(most_popular$track.album.release_date, na.rm = T)-5000,
y = 20000,
label = paste0("Mediana: ", year(median(most_popular$track.album.release_date, na.rm = T))))+
labs(title = "Distribution of Song Release Date",
subtitle = "Popular songs (200 Top)",
x = "Release Date",
y = "")
quantile(most_popular$track.album.release_date, na.rm = T)
quantile(most_popular$track.album.release_date)
quantile(most_popular$track.album.release_date, na.rm = T)
most_popular %>% select(track.album.release_date) %>% summarise()
most_popular %>% select(track.album.release_date) %>% summary()
most_popular %>% summary()
View(monthly_pop)
songs_pop %>%
ggplot()+
geom_histogram(aes(x = track.album.release_date, y= ..count..),
fill = '#2980b9')+
theme_minimal()+
geom_vline(aes(xintercept = median(songs_pop$track.album.release_date, na.rm = T)))+
annotate(geom = "text",
x = median(songs_pop$track.album.release_date, na.rm = T)-5000,
y = 20000,
label = paste0("Mediana: ", year(median(songs_pop$track.album.release_date, na.rm = T))))+
labs(title = "Distribution of Song Release Date",
subtitle = "Popular songs (200 Top)",
x = "Release Date",
y = "")
songs_pop %>%
ggplot()+
geom_histogram(aes(x = track.album.release_date, y= ..count..),
fill = '#2980b9')+
theme_minimal()+
geom_vline(aes(xintercept = median(songs_pop$track.album.release_date, na.rm = T)))+
annotate(geom = "text",
x = median(songs_pop$track.album.release_date, na.rm = T)-5000,
y = 4000,
label = paste0("Mediana: ", year(median(songs_pop$track.album.release_date, na.rm = T))))+
labs(title = "Distribution of Song Release Date",
subtitle = "Popular songs (200 Top)",
x = "Release Date",
y = "")
songs_pop %>% select(track.album.release_date) %>% summary()
songs_pop %>%
select(track.album.release_date) %>%
summary()
all_songs %>%
select(track.album.release_date) %>%
summary()
# create dataframe with continuous features
MP_continuous <- songs_pop %>%
select(-c('id','date','ano','mes','track.popularity','track.album.release_date',
'track.album.release_date_precision', 'ano_mes', 'key', 'mode',
'time_signature', 'track.album.id'))
# create dataframe with continuous features
MP_continuous <- songs_pop %>%
select(-c('id', 'track.popularity','track.album.release_date',
'track.album.release_date_precision', 'ano_mes', 'key', 'mode',
'time_signature', 'track.album.id'))
# create dataframe with continuous features
MP_continuous <- songs_pop %>%
select(-c('id', 'track.popularity','track.album.release_date',
'track.album.release_date_precision', 'key', 'mode',
'time_signature', 'track.album.id'))
# scale dataframe with continuous features
MP_continuous %<>%
scale() %>%
data.frame()
# create dataframe with factors features
MP_factors <- songs_pop %>%
select(c('key', 'mode', 'time_signature')) %>%
data.frame()
# create cluster model
model <- kamila(MP_continuous, MP_factors, numClust = 2 : 10, numInit = 10,
calcNumClust = "ps", numPredStrCvRun = 10, predStrThresh = 0.5)
songs_pop %>% summary()
# dataframe filtered
songs_pop <- most_popular %>%
select(-c(date, mes, ano, ano_mes)) %>%
unique()
# create dataframe with continuous features
MP_continuous <- songs_pop %>%
select(-c('id', 'track.popularity','track.album.release_date',
'track.album.release_date_precision', 'key', 'mode',
'time_signature', 'track.album.id', 'is_hit'))
# create dataframe with continuous features
MP_continuous <- songs_pop %>%
select(-c('id', 'track.popularity','track.album.release_date',
'track.album.release_date_precision', 'key', 'mode',
'time_signature', 'track.album.id', 'is_hit'))
# dataframe filtered
songs_pop <- most_popular %>%
select(-c(date, mes, ano, ano_mes)) %>%
unique()
songs_pop %>% summary()
# settings
setwd("~/Desktop/TCC")
# load required packages
library(tidyverse)
library(magrittr)
library(lubridate)
library(kamila)
# read databases
all_songs <- read_csv('2.Datasets/features.csv')
most_popular <- read_csv('2.Datasets/most_popular.csv')
# encode factors features
all_songs$time_signature %<>% as.factor()
all_songs$mode %<>% as.factor()
all_songs$key %<>% as.factor()
most_popular$time_signature %<>% as.factor()
most_popular$mode %<>% as.factor()
most_popular$key %<>% as.factor()
# encode date features
all_songs$track.album.release_date %<>% as.Date()
most_popular$date %<>% as.Date()
most_popular$track.album.release_date %<>% as.Date()
most_popular$ano_mes <- as.yearmon(most_popular$date)
most_popular$ano_mes %<>% factor(ordered = TRUE)
# dataframe filtered
songs_pop <- most_popular %>%
select(-c(date, mes, ano, ano_mes)) %>%
unique()
# create dataframe with continuous features
MP_continuous <- songs_pop %>%
select(-c('id', 'track.popularity','track.album.release_date',
'track.album.release_date_precision', 'key', 'mode',
'time_signature', 'track.album.id', 'days_in_month'))
songs_pop %>% summary()
# create dataframe with continuous features
MP_continuous <- songs_pop %>%
select(-c('id', 'track.popularity','track.album.release_date',
'track.album.release_date_precision', 'key', 'mode',
'time_signature', 'track.album.id'))
MP_continuous %>% summary()
# scale dataframe with continuous features
MP_continuous %<>%
scale() %>%
data.frame()
# create dataframe with factors features
MP_factors <- songs_pop %>%
select(c('key', 'mode', 'time_signature')) %>%
data.frame()
MP_factors %>% summary()
# create cluster model
model <- kamila(MP_continuous, MP_factors, numClust = 2 : 10, numInit = 10,
calcNumClust = "ps", numPredStrCvRun = 10, predStrThresh = 0.5)
# plot selected cluster
plot(2:5, model$nClust$psValues)
# plot selected cluster
plot(2:10, model$nClust$psValues)
model$nClust$bestNClust
?kamila
